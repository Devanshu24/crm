(base) dell5810@dell5810:~/tdash/crm/Winnow2$ bash run.bash chess3 rand_crm_1npd3nrs_train_features_pos rand_crm_1npd3nrs_train_features_neg rand_crm_1npd3nrs_test_features_pos rand_crm_1npd3nrs_test_features_neg
Reading file: train.pos
Reading file: train.neg
Number of data instances: 10000
Number of features: 262
Reading file: test.pos
Reading file: test.neg
Number of data instances: 3752
Number of features: 262
Dimension of Data ( Instances:  10000 , Features:  262  )
Dimension of X:  (10000, 262)
Dimension of y:  (10000,)

Dimension of X_train:  (8000, 262)
Dimension of y_train:  (8000,)
Dimension of X_val:  (2000, 262)
Dimension of y_val:  (2000,)

Dimension of Data_test ( Instances:  3752 , Features:  262  )
Dimension of X:  (3752, 262)
Dimension of y:  (3752,)
-----------------------------------------------------------------
Trying::	 alpha: 2 threshold: 262 	( 1 of 6 )
-----------------------------------------------------------------
[Selected] at epoch 0 	train_perf: 0.9962 	val_perf: 0.9960
[Selected] at epoch 1 	train_perf: 0.9954 	val_perf: 0.9970
[Selected] at epoch 2 	train_perf: 0.9998 	val_perf: 0.9985
[Selected] at epoch 12 	train_perf: 0.9992 	val_perf: 1.0000
Stopping early after epoch 33
Model found and saved.

-----------------------------------------------------------------
Trying::	 alpha: 2 threshold: 131 	( 2 of 6 )
-----------------------------------------------------------------
Stopping early after epoch 20
No better model found.

-----------------------------------------------------------------
Trying::	 alpha: 3 threshold: 262 	( 3 of 6 )
-----------------------------------------------------------------
Stopping early after epoch 20
No better model found.

-----------------------------------------------------------------
Trying::	 alpha: 3 threshold: 131 	( 4 of 6 )
-----------------------------------------------------------------
Stopping early after epoch 20
No better model found.

-----------------------------------------------------------------
Trying::	 alpha: 4 threshold: 262 	( 5 of 6 )
-----------------------------------------------------------------
Stopping early after epoch 20
No better model found.

-----------------------------------------------------------------
Trying::	 alpha: 4 threshold: 131 	( 6 of 6 )
-----------------------------------------------------------------
Stopping early after epoch 20
No better model found.

Best model: {'W': array([6.40000000e+01, 1.56250000e-02, 1.25000000e-01, 6.40000000e+01,
       1.56250000e-02, 3.12500000e-02, 3.72529030e-09, 1.90734863e-06,
       2.98023224e-08, 2.98023224e-08, 2.38418579e-07, 1.90734863e-06,
       5.96046448e-08, 5.96046448e-08, 1.86264515e-09, 7.62939453e-06,
       7.62939453e-06, 2.98023224e-08, 1.90734863e-06, 5.96046448e-08,
       3.72529030e-09, 1.49011612e-08, 1.56250000e-02, 1.45519152e-11,
       3.90625000e-03, 2.00000000e+00, 4.00000000e+00, 8.00000000e+00,
       1.28000000e+02, 1.28000000e+02, 1.60000000e+01, 5.00000000e-01,
       2.00000000e+00, 6.40000000e+01, 3.20000000e+01, 1.25000000e-01,
       6.40000000e+01, 3.12500000e-02, 1.60000000e+01, 1.60000000e+01,
       4.88281250e-04, 2.00000000e+00, 4.00000000e+00, 2.50000000e-01,
       2.00000000e+00, 2.00000000e+00, 6.25000000e-02, 1.95312500e-03,
       1.25000000e-01, 1.60000000e+01, 2.00000000e+00, 3.90625000e-03,
       1.95312500e-03, 1.56250000e-02, 1.95312500e-03, 1.60000000e+01,
       1.60000000e+01, 7.62939453e-06, 8.00000000e+00, 2.00000000e+00,
       2.56000000e+02, 2.00000000e+00, 1.60000000e+01, 6.25000000e-02,
       3.12500000e-02, 2.50000000e-01, 2.00000000e+00, 2.00000000e+00,
       2.44140625e-04, 9.76562500e-04, 1.25000000e-01, 1.60000000e+01,
       4.00000000e+00, 3.90625000e-03, 3.90625000e-03, 3.20000000e+01,
       1.60000000e+01, 1.00000000e+00, 1.00000000e+00, 2.00000000e+00,
       8.00000000e+00, 1.28000000e+02, 1.28000000e+02, 6.40000000e+01,
       1.60000000e+01, 5.00000000e-01, 6.40000000e+01, 1.56250000e-02,
       2.50000000e-01, 2.50000000e-01, 1.56250000e-02, 3.12500000e-02,
       1.56250000e-02, 2.50000000e-01, 4.00000000e+00, 1.00000000e+00,
       8.00000000e+00, 8.00000000e+00, 7.81250000e-03, 9.76562500e-04,
       1.56250000e-02, 9.76562500e-04, 5.00000000e-01, 1.00000000e+00,
       7.81250000e-03, 1.95312500e-03, 1.25000000e-01, 6.25000000e-02,
       8.00000000e+00, 1.00000000e+00, 2.00000000e+00, 1.00000000e+00,
       1.25000000e-01, 1.95312500e-03, 3.12500000e-02, 3.72529030e-09,
       2.50000000e-01, 5.00000000e-01, 7.45058060e-09, 9.53674316e-07,
       9.53674316e-07, 1.22070312e-04, 4.76837158e-07, 1.56250000e-02,
       1.56250000e-02, 7.62939453e-06, 2.44140625e-04, 5.00000000e-01,
       1.90734863e-06, 5.00000000e-01, 1.22070312e-04, 4.00000000e+00,
       1.28000000e+02, 7.45058060e-09, 1.95312500e-03, 3.90625000e-03,
       6.10351562e-05, 2.44140625e-04, 1.95312500e-03, 7.81250000e-03,
       7.81250000e-03, 1.56250000e-02, 1.00000000e+00, 9.76562500e-04,
       2.00000000e+00, 6.25000000e-02, 9.31322575e-10, 3.72529030e-09,
       2.00000000e+00, 3.90625000e-03, 1.25000000e-01, 7.62939453e-06,
       2.50000000e-01, 1.52587891e-05, 1.52587891e-05, 3.90625000e-03,
       7.81250000e-03, 2.38418579e-07, 4.88281250e-04, 1.95312500e-03,
       2.44140625e-04, 1.16415322e-10, 1.95312500e-03, 2.44140625e-04,
       1.52587891e-05, 4.88281250e-04, 3.90625000e-03, 3.12500000e-02,
       7.81250000e-03, 3.12500000e-02, 1.22070312e-04, 2.44140625e-04,
       6.25000000e-02, 1.22070312e-04, 1.28000000e+02, 4.88281250e-04,
       7.81250000e-03, 2.44140625e-04, 1.95312500e-03, 1.95312500e-03,
       9.76562500e-04, 1.25000000e-01, 2.44140625e-04, 1.90734863e-06,
       9.53674316e-07, 4.88281250e-04, 3.05175781e-05, 4.88281250e-04,
       7.81250000e-03, 4.88281250e-04, 7.81250000e-03, 9.76562500e-04,
       3.90625000e-03, 2.50000000e-01, 1.95312500e-03, 2.44140625e-04,
       3.81469727e-06, 6.25000000e-02, 3.05175781e-05, 5.96046448e-08,
       6.40000000e+01, 2.50000000e-01, 1.16415322e-10, 9.76562500e-04,
       9.53674316e-07, 1.56250000e-02, 6.10351562e-05, 1.00000000e+00,
       3.81469727e-06, 7.81250000e-03, 6.40000000e+01, 1.16415322e-10,
       6.10351562e-05, 9.53674316e-07, 4.88281250e-04, 9.76562500e-04,
       1.00000000e+00, 1.52587891e-05, 9.31322575e-10, 2.38418579e-07,
       2.00000000e+00, 3.05175781e-05, 3.90625000e-03, 4.76837158e-07,
       3.81469727e-06, 1.00000000e+00, 2.44140625e-04, 1.19209290e-07,
       3.12500000e-02, 7.81250000e-03, 3.12500000e-02, 9.76562500e-04,
       2.00000000e+00, 1.45519152e-11, 6.40000000e+01, 3.90625000e-03,
       7.81250000e-03, 9.76562500e-04, 1.56250000e-02, 1.00000000e+00,
       9.76562500e-04, 3.05175781e-05, 7.62939453e-06, 9.53674316e-07,
       7.81250000e-03, 4.00000000e+00, 3.20000000e+01, 3.05175781e-05,
       1.52587891e-05, 1.56250000e-02, 4.00000000e+00, 7.62939453e-06,
       7.81250000e-03, 6.25000000e-02, 5.12000000e+02, 7.45058060e-09,
       3.81469727e-06, 1.95312500e-03, 2.38418579e-07, 4.88281250e-04,
       7.62939453e-06, 9.76562500e-04]), 'alpha': 2, 'thres': 262, 'train_perf': 0.99925, 'val_perf': 1.0}
Independent test accuracy: 0.9965351812366737
(base) dell5810@dell5810:~/tdash/crm/Winnow2$ vi preparedata.m
(base) dell5810@dell5810:~/tdash/crm/Winnow2$ vi preparedata.m
(base) dell5810@dell5810:~/tdash/crm/Winnow2$ vi winnow2.py
(base) dell5810@dell5810:~/tdash/crm/Winnow2$ python
Python 3.7.6 (default, Jan  8 2020, 19:59:22)
[GCC 7.3.0] :: Anaconda, Inc. on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import numpy as np
>>> import pandas as pd
>>> with open('model.pkl', 'rb') as fp:
...     savedmodel = pickle.load(fp)
...
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
NameError: name 'pickle' is not defined
>>> import pickle
>>> with open('model.pkl', 'rb') as fp:
...     savedmodel = pickle.load(fp)
...
>>> DF = pd.DataFrame(savedmodel['W'])
>>> DF.to_csv("weights.csv")
